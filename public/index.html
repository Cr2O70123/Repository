<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Clash Online Pro</title>
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>

    <!-- 1. 登入頁面 -->
    <div id="page-login" class="page active">
        <div class="login-panel">
            <div class="logo-area">
                <h1>CLASH<br>ONLINE</h1>
                <div class="subtitle">榮耀戰場</div>
            </div>
            <input type="text" id="username" class="input-box" placeholder="請輸入暱稱" maxlength="10">
            <button class="btn btn-large" onclick="App.login()">進入遊戲</button>
            <div style="margin-top:20px; color:#aaa; font-size:12px;">Ver 2.0.0 | 連線伺服器版</div>
        </div>
    </div>

    <!-- 2. 大廳頁面 (Lobby) -->
    <div id="page-lobby" class="page hidden">
        <div class="top-bar">
            <div class="user-info">
                <div class="avatar">👤</div>
                <div class="name-box">
                    <span id="lobby-name">Player</span>
                    <span class="gold-display">💰 <span id="lobby-gold">0</span></span>
                </div>
            </div>
            <button class="btn-icon" onclick="App.showSettings()">⚙️</button>
        </div>

        <div class="lobby-center">
            <div class="hero-graphic">👑</div>
            <div id="match-status" class="status-text">準備就緒</div>
            <button class="btn btn-play" onclick="App.findMatch()">開始對戰</button>
        </div>

        <div class="bottom-nav">
            <div class="nav-item" onclick="App.nav('shop')">🛒<br>商店</div>
            <div class="nav-item" onclick="App.nav('deck')">🃏<br>牌組</div>
            <div class="nav-item active">🏠<br>大廳</div>
            <div class="nav-item" onclick="App.nav('leaderboard')">🏆<br>排行</div>
            <div class="nav-item" onclick="App.nav('profile')">📊<br>戰績</div>
        </div>
        
        <!-- 每日簽到懸浮鈕 -->
        <button class="btn-checkin" onclick="App.dailyCheckIn()">📅 簽到領獎</button>
    </div>

    <!-- 3. 商店 (Shop) -->
    <div id="page-shop" class="page hidden">
        <div class="header">
            <button class="btn-back" onclick="App.nav('lobby')">⬅</button>
            <h2>卡牌商店</h2>
            <div class="header-gold">💰 <span id="shop-gold">0</span></div>
        </div>
        <div id="shop-list" class="scroll-view grid-layout"></div>
    </div>

    <!-- 4. 牌組 (Deck) -->
    <div id="page-deck" class="page hidden">
        <div class="header">
            <button class="btn-back" onclick="App.nav('lobby')">⬅</button>
            <h2>編輯牌組 (6張)</h2>
            <button class="btn-small" onclick="App.saveDeck()">保存</button>
        </div>
        <div class="deck-preview">
            <div style="color:#aaa; font-size:12px; margin-bottom:5px;">已選卡牌</div>
            <div id="current-deck-row" class="mini-card-row"></div>
        </div>
        <div id="deck-collection" class="scroll-view grid-layout"></div>
    </div>

    <!-- 5. 排行榜 (Leaderboard) -->
    <div id="page-leaderboard" class="page hidden">
        <div class="header">
            <button class="btn-back" onclick="App.nav('lobby')">⬅</button>
            <h2>世界排行榜</h2>
        </div>
        <div class="panel full-panel">
            <table class="rank-table">
                <thead><tr><th>#</th><th>玩家</th><th>勝場</th><th>財富</th></tr></thead>
                <tbody id="leaderboard-list"></tbody>
            </table>
        </div>
    </div>

    <!-- 6. 個人資料 (Profile) -->
    <div id="page-profile" class="page hidden">
        <div class="header">
            <button class="btn-back" onclick="App.nav('lobby')">⬅</button>
            <h2>個人檔案</h2>
        </div>
        <div class="profile-card">
            <div class="big-avatar">👤</div>
            <h3 id="p-name">Name</h3>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="val" id="p-wins" style="color:#2ecc71">0</div>
                    <div class="label">勝利</div>
                </div>
                <div class="stat-box">
                    <div class="val" id="p-loss" style="color:#e74c3c">0</div>
                    <div class="label">敗北</div>
                </div>
                <div class="stat-box">
                    <div class="val" id="p-rate">0%</div>
                    <div class="label">勝率</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 7. 遊戲戰鬥畫面 (Canvas) -->
    <div id="page-game" class="page hidden">
        <div id="game-ui-wrapper">
            <canvas id="gameCanvas"></canvas>
            
            <!-- 上方資訊 -->
            <div id="hud-top">
                <div id="enemy-info">⚔️ <span id="enemy-name">對手</span></div>
                <div id="timer-box"><div id="timer">03:00</div></div>
            </div>

            <!-- 訊息提示 -->
            <div id="msg-overlay"></div>
            <div id="elixir-mode-msg">雙倍聖水時刻!</div>

            <!-- 表情與投降 -->
            <div id="game-controls">
                <button class="btn-round" onclick="Game.surrender()">🏳️</button>
                <div style="position:relative;">
                    <button class="btn-round" onclick="document.getElementById('emote-box').classList.toggle('show')">💬</button>
                    <div id="emote-box">
                        <span onclick="Game.sendEmote('😂')">😂</span>
                        <span onclick="Game.sendEmote('😡')">😡</span>
                        <span onclick="Game.sendEmote('😭')">😭</span>
                        <span onclick="Game.sendEmote('👍')">👍</span>
                    </div>
                </div>
            </div>

            <!-- 下方卡牌區 -->
            <div id="hud-bottom">
                <div class="elixir-bar-container">
                    <div class="elixir-num" id="elixir-num">5</div>
                    <div class="elixir-track"><div id="elixir-fill"></div></div>
                </div>
                <div class="cards-container">
                    <div class="next-card-slot">
                        <span>下張</span>
                        <div class="mini-card" id="next-card-icon">?</div>
                    </div>
                    <div id="hand-cards"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 8. 結算彈窗 -->
    <div id="result-modal" class="modal hidden">
        <div class="modal-content">
            <h1 id="result-title">VICTORY</h1>
            <div id="result-reward">金幣 +50</div>
            <button class="btn" onclick="App.nav('lobby')">返回大廳</button>
        </div>
    </div>

    <!-- JS Files -->
    <script src="js/data.js"></script>
    <script src="js/game.js"></script>
</body>
</html>