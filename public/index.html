<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>迷你皇室戰爭</title>
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>

    <!-- 大廳 (Lobby) -->
    <div id="page-lobby" class="page active">
        <div class="lobby-header">
            <div class="currency">💰 <span id="gold-display">0</span></div>
            <div class="btn-secondary" style="padding:5px 15px; border-radius:20px;" onclick="App.nav('profile')">👤 個人檔案</div>
        </div>
        
        <div class="lobby-main">
            <div class="title-group">
                <h1>CLASH<br>ONLINE</h1>
                <div class="subtitle">榮耀戰場</div>
            </div>

            <input type="text" id="nickname" class="input-box" placeholder="輸入暱稱" maxlength="8">
            
            <div style="display:flex; align-items:center; color:#bdc3c7; height:30px; margin-bottom:10px;">
                <div class="spinner" id="wait-spinner"></div>
                <div id="match-status-txt">準備就緒</div>
            </div>

            <button class="btn" id="find-btn" style="font-size:24px; width:80%; max-width:300px;" onclick="Game.findMatch()">開始對戰</button>
            
            <div class="menu-grid">
                <button class="btn btn-secondary" onclick="Game.openDeckEditor()">編輯牌組</button>
                <button class="btn btn-secondary" onclick="App.nav('shop')">商店</button>
                <button class="btn btn-secondary" onclick="App.nav('leaderboard')">排行榜</button>
                <button class="btn btn-secondary" onclick="App.dailyCheckIn()">每日簽到</button>
            </div>
        </div>
    </div>

    <!-- 商店 (Shop) -->
    <div id="page-shop" class="page hidden">
        <div class="overlay" style="display:flex; height:100%;">
            <div class="panel full-panel">
                <h2 style="color:var(--accent);">卡牌商店</h2>
                <div class="currency">💰 <span id="shop-gold">0</span></div>
                <div id="shop-list" class="scroll-content"></div>
                <button class="btn btn-secondary" style="margin-top:10px; width:100%;" onclick="App.nav('lobby')">返回大廳</button>
            </div>
        </div>
    </div>

    <!-- 排行榜 (Leaderboard) -->
    <div id="page-leaderboard" class="page hidden">
        <div class="overlay" style="display:flex; height:100%;">
            <div class="panel full-panel">
                <h2 style="color:var(--accent);">排行榜</h2>
                <div id="leaderboard-list" class="scroll-content"></div>
                <button class="btn btn-secondary" style="margin-top:10px; width:100%;" onclick="App.nav('lobby')">返回大廳</button>
            </div>
        </div>
    </div>

    <!-- 個人檔案 (Profile) -->
    <div id="page-profile" class="page hidden">
        <div class="overlay" style="display:flex; height:100%;">
            <div class="panel full-panel">
                <h2 style="color:var(--accent);">個人戰績</h2>
                <div style="text-align:left; width:100%; padding:10px; box-sizing:border-box; background:rgba(255,255,255,0.1); border-radius:10px;">
                    <p>暱稱: <strong id="p-name"></strong></p>
                    <p>勝場: <strong id="p-wins" style="color:#2ecc71">0</strong></p>
                    <p>敗場: <strong id="p-loss" style="color:#e74c3c">0</strong></p>
                    <p>勝率: <strong id="p-rate">0%</strong></p>
                </div>
                <button class="btn btn-secondary" style="margin-top:10px; width:100%;" onclick="App.nav('lobby')">返回大廳</button>
            </div>
        </div>
    </div>

    <!-- 編輯器 (Editor) -->
    <div id="deck-editor" class="page overlay hidden">
        <div class="panel full-panel">
            <h2 style="color:var(--accent); margin:0 0 5px 0;">配置牌組 (6張)</h2>
            <div id="editor-grid"></div>
            <div id="editor-desc" class="editor-desc">點擊卡牌查看詳情</div>
            <button class="btn" style="margin-top:10px;" onclick="Game.closeDeckEditor()">保存並返回</button>
        </div>
    </div>

    <!-- 遊戲畫面 (Game) -->
    <div id="page-game" class="page hidden">
        <div id="game-container">
            <div id="canvas-wrapper">
                <canvas id="gameCanvas"></canvas>
                <div id="hud-top">
                    <div id="enemy-info">⚔️ <span id="enemy-name-txt">...</span></div>
                    <div id="timer-box"><div id="timer">03:00</div></div>
                    <button class="btn-surrender" onclick="Game.surrender()">🏳️</button>
                </div>
                
                <div id="emote-wrapper">
                    <div id="emote-menu">
                        <div class="emote-opt" onclick="Game.triggerEmote('😂')">😂</div>
                        <div class="emote-opt" onclick="Game.triggerEmote('😡')">😡</div>
                        <div class="emote-opt" onclick="Game.triggerEmote('😭')">😭</div>
                        <div class="emote-opt" onclick="Game.triggerEmote('👍')">👍</div>
                    </div>
                    <div id="emote-btn" onclick="document.getElementById('emote-menu').classList.toggle('open')">💬</div>
                </div>

                <div id="elixir-mode-txt">雙倍聖水時刻!</div>
                <div id="message"></div>
            </div>

            <div id="ui-layer">
                <div id="elixir-area">
                    <div id="elixir-badge">5</div>
                    <div id="elixir-bar-bg"><div id="elixir-fill"></div></div>
                </div>
                <div id="deck-area">
                    <div id="next-slot">
                        <span class="slot-label">下張</span>
                        <div class="card" style="height:60px; width:50px; pointer-events:none;">
                            <div class="card-inner"><div class="emoji" id="next-icon">?</div></div>
                        </div>
                    </div>
                    <div id="hand-cards"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 結算 -->
    <div id="end-screen" class="page overlay hidden">
        <h1 id="end-title" style="font-size:80px;">勝利</h1>
        <div style="text-align:center; margin-bottom:20px; font-size:20px;">
            獲得金幣: <span id="reward-gold" style="color:gold; font-weight:bold;">0</span>
        </div>
        <button class="btn" onclick="location.reload()">返回大廳</button>
    </div>

    <!-- JS Files -->
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/game.js"></script>
</body>
</html>